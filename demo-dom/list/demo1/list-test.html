<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>list operate</title>
    <!-- STYLE -->
    <link rel="stylesheet" href="./css/base.css"/>
    <link rel="stylesheet" href="./css/grid.css"/>
    <link rel="stylesheet" href="./css/module.css"/>
    <link rel="stylesheet" href="./css/unit.css"/>
    <link rel="stylesheet" href="./css/frame.css">
    <link rel="stylesheet" href="./css/layer.css">
    <link rel="stylesheet" href="./css/pages/style_dark.css">
    <link rel="stylesheet" href="./css/pages/style_light.css">
    <!-- SKIN -->
     
    <link rel="stylesheet" href="./skin/default/web/css/skin_frame.css">
    <link rel="stylesheet" href="./skin/default/web/css/skin_dark.css">
    <link rel="stylesheet" href="./skin/default/web/css/skin_light.css">
    <style>
    body{overflow-y:auto;border:0;}
    h1{font-size:30px; margin:20px 0; font-weight:bold; text-align:center;}
    .whitebg{margin:10px 0;padding:10px; background:#eeeff2; text-shadow:0 1px rgba(255,255,255,0.5);color:#333;}
    .whitebg h1{ color:#333; text-shadow:none;}
    .g-bd{position:static;min-height:0;padding:30px;}
    .m-layer.z-show,.m-menu,.m-dragmdl{position:relative;top:auto;left:auto;}
    .m-dragmdl{margin:20px;}
    #parent .fix{width:86px;}
    #parent .flow{margin-left:86px;}
    #parent .o-love{width:34px;}
    #parent .o-love .xlv{margin:3px 0 0;}


    .menu{position:fixed;width:150px;background:#F7F8F9;color:#010101;text-align:left;text-shadow:none;}
    .menu .itm{height:30px;line-height:30px;padding:5px 30px;}
    .menu .itm:hover{background:#E9EAEC;}
    </style>
	</head>

	<body>
		<div class="m-plylist m-plylist-sort s-bfc5" id="parent">
			<div class="head f-cb">
				<div class="fix">
					<div class="th col f-pr"></div>
					<div class="th col o-love">
						<span class="ico xlv u-icn4 u-icn4-love j-lvbtn" id="love-all-action"></span>
					</div>
				</div>
				<div class="flow f-cb">
					<div class="th col">音乐标题</div>
					<div class="th col">歌手</div>
					<div class="th col">专辑</div>
					<div class="th col">时长</div>
				</div>
			</div>
			<ul>
				<li class="itm j-item"> <span class="ico u-icn4 u-icn4-love j-love"></span>
					<div class="flow f-cb">
						<div class="td col title"> <a href="/track/29732729/" class="tit s-bfc8">小鸡哔哔</a> </div>
						<div class="td col ellipsis"> <a href="/artist/122455/" class="s-bfc8 ">群星</a> </div>
						<div class="td col ellipsis"> <a href="/album/2767230/" class="s-bfc4">热门华语205</a> </div>
						<div class="td col">02:40</div>
					</div>
				</li>
				<li class="itm j-item"> <span class="ico u-icn4 u-icn4-love j-love"></span>
					<div class="flow f-cb">
						<div class="td col title"> <a href="/track/29732729/" class="tit s-bfc8">小鸡哔哔</a> </div>
						<div class="td col ellipsis"> <a href="/artist/122455/" class="s-bfc8 ">群星</a> </div>
						<div class="td col ellipsis"> <a href="/album/2767230/" class="s-bfc4">热门华语205</a> </div>
						<div class="td col">02:40</div>
					</div>
				</li>
				<li class="itm j-item"> <span class="ico u-icn4 u-icn4-love j-love"></span>
					<div class="flow f-cb">
						<div class="td col title"> <a href="/track/29732729/" class="tit s-bfc8">小鸡哔哔</a> </div>
						<div class="td col ellipsis"> <a href="/artist/122455/" class="s-bfc8 ">群星</a> </div>
						<div class="td col ellipsis"> <a href="/album/2767230/" class="s-bfc4">热门华语205</a> </div>
						<div class="td col">02:40</div>
					</div>
				</li>
				<li class="itm j-item"> <span class="ico u-icn4 u-icn4-love j-love"></span>
					<div class="flow f-cb">
						<div class="td col title"> <a href="/track/29732729/" class="tit s-bfc8">小鸡哔哔</a> </div>
						<div class="td col ellipsis"> <a href="/artist/122455/" class="s-bfc8 ">群星</a> </div>
						<div class="td col ellipsis"> <a href="/album/2767230/" class="s-bfc4">热门华语205</a> </div>
						<div class="td col">02:40</div>
					</div>
				</li>
				<li class="itm j-item"> <span class="ico u-icn4 u-icn4-love j-love"></span>
					<div class="flow f-cb">
						<div class="td col title"> <a href="/track/29732729/" class="tit s-bfc8">小鸡哔哔</a> </div>
						<div class="td col ellipsis"> <a href="/artist/122455/" class="s-bfc8 ">群星</a> </div>
						<div class="td col ellipsis"> <a href="/album/2767230/" class="s-bfc4">热门华语205</a> </div>
						<div class="td col">02:40</div>
					</div>
				</li>
				<li class="itm j-item"> <span class="ico u-icn4 u-icn4-love j-love"></span>
					<div class="flow f-cb">
						<div class="td col title"> <a href="/track/29732729/" class="tit s-bfc8">小鸡哔哔</a> </div>
						<div class="td col ellipsis"> <a href="/artist/122455/" class="s-bfc8 ">群星</a> </div>
						<div class="td col ellipsis"> <a href="/album/2767230/" class="s-bfc4">热门华语205</a> </div>
						<div class="td col">02:40</div>
					</div>
				</li>
				<li class="itm j-item"> <span class="ico u-icn4 u-icn4-love j-love"></span>
					<div class="flow f-cb">
						<div class="td col title"> <a href="/track/29732729/" class="tit s-bfc8">小鸡哔哔</a> </div>
						<div class="td col ellipsis"> <a href="/artist/122455/" class="s-bfc8 ">群星</a> </div>
						<div class="td col ellipsis"> <a href="/album/2767230/" class="s-bfc4">热门华语205</a> </div>
						<div class="td col">02:40</div>
					</div>
				</li>
			</ul>
		</div>
		<!-- base -->
		<script type="text/javascript">
			// event(事件)工具集，来源：github.com/markyun
		    var Event = {
		        // 页面加载完成后
		        readyEvent : function(fn) {
		            if (fn==null) {
		                fn=document;
		            }
		            var oldonload = window.onload;
		            if (typeof window.onload != 'function') {
		                window.onload = fn;
		            } else {
		                window.onload = function() {
		                    oldonload();
		                    fn();
		                };
		            }
		        },
		        // 视能力分别使用dom0||dom2||IE方式 来绑定事件
		        // 参数： 操作的元素,事件名称 ,事件处理程序
		        addEvent : function(element, type, handler) {
		            if (element.addEventListener) {
		                //事件类型、需要执行的函数、是否捕捉
		                element.addEventListener(type, handler, false);
		            } else if (element.attachEvent) {
		                element.attachEvent('on' + type, function() {
		                    handler.call(element);
		                });
		            } else {
		                element['on' + type] = handler;
		            }
		        },
		        // 移除事件
		        removeEvent : function(element, type, handler) {
		            if (element.removeEnentListener) {
		                element.removeEnentListener(type, handler, false);
		            } else if (element.datachEvent) {
		                element.detachEvent('on' + type, handler);
		            } else {
		                element['on' + type] = null;
		            }
		        }, 
		        // 阻止事件 (主要是事件冒泡，因为IE不支持事件捕获)
		        stopPropagation : function(ev) {
		            if (ev.stopPropagation) {
		                ev.stopPropagation();
		            } else {
		                ev.cancelBubble = true;
		            }
		        },
		        // 取消事件的默认行为
		        preventDefault : function(event) {
		            if (event.preventDefault) {
		                event.preventDefault();
		            } else {
		                event.returnValue = false;
		            }
		        },
		        // 获取事件目标
		        getTarget : function(event) {
		            return event.target || event.srcElement;
		        },
		        // 获取event对象的引用，取到事件的所有信息，确保随时能使用event；
		        getEvent : function(e) {
		            var ev = e || window.event;
		            if (!ev) {
		                var c = this.getEvent.caller;
		                while (c) {
		                    ev = c.arguments[0];
		                    if (ev && Event == ev.constructor) {
		                        break;
		                    }
		                    c = c.caller;
		                }
		            }
		            return ev;
		        }
		    };
		    var Str = {
		    	trim:function(str){
		    		return str.replace(/^\s+|\s+$/g,'');
		    	}
		    }
		    var Dom = {
		    	hasClass:function(nd,cl){
		    		return nd.className && (' '+nd.className+' ').indexOf(' '+cl+' ') !== -1;
		    	},
		    	addClass:function(nd,cl){
		    		if(!Dom.hasClass(nd,cl)){
		    			nd.className += ' '+cl;
		    		}
		    	},
		    	removeClass:function(nd,cl){
		    		if(Dom.hasClass(nd,cl)){
		    			var str = (' '+nd.className+' ').replace(' '+cl+' ',' ')
		    			nd.className = Str.trim(str);
		    		}
		    	}
		    };
		</script>
		<script type="text/javascript">
			var parent = document.getElementById('parent');
			var selection = [],
				loves = [];
			function isLoved(node){
				return loves.indexOf(node) !== -1;
			}
			function love(node,flag) {
			 	if(flag){
			 		loves.push(node.parentNode);
			 		Dom.addClass(node,"u-icn4-loved");
			 	}else{
			 		loves.splice(loves.indexOf(node),1);
			 		Dom.removeClass(node,"u-icn4-loved");
			 	}
			 }
			 function select(node,flag){
			 	if(flag){
			 		appendToSelection(node);
			 	}else{
			 		removeFromSelection(node);
			 	}
			 }
			 function appendToSelection(node){
		 		if(!Dom.hasClass(node,'z-sel')){
		 			Dom.addClass(node,'z-sel');
		 		}
			 	selection.push(node);
			 }
			 function removeFromSelection(node){
			 	selection.splice(selection.indexOf(node),1);
			 	Dom.removeClass(node,'z-sel');
			 }
			 function getTarget(e,_class){
			 	var ev = Event.getEvent(e);
			 	var node = Event.getTarget(ev);
			 	_class = _class? _class : 'j-item';
			 	while(node){
			 		if(Dom.hasClass(node,_class)) return node;
			 		node = node.parentNode;
			 	}
			 }
			 function isSelected(node){
			 	return selection.indexOf(node) !== -1;
			 }
			 function clearSelection(){
			 	if(selection.length){
			 		for(var i=0,v;v=selection[i];i++){
			 			Dom.removeClass(v,'z-sel');
			 		}
			 		selection = [];
		 		}
			 }
			 //单选
			 Event.addEvent(parent,"mousedown",function(e){
			 	var tar = getTarget(e);
			 	if(!tar) return;
			 	if(isSelected(tar)){
			 		select(tar,false);
			 	}else{
			 		clearSelection();
			 		select(tar,true);
			 	}
			 });
			 //单个加心
			 Event.addEvent(parent,"mousedown",function(e){
			 	var tar = getTarget(e,'j-love');
			 	if(!tar) return;
		 		love(tar,!isLoved(tar.parentNode));
			 });
			 Event.addEvent(parent,"mouseup",function(e){
			 	var tar = getTarget(e);
			 	if(!tar) return;
			 	if(e.ctrlKey){
			 		select(tar,isSelected(tar));
			 	}
			 })
		</script>
	</body>
</html>